# =========================
# EXPLAIN AI ‚Äî –†–ï–ü–ï–¢–ò–¢–û–†
# =========================

import ast
import copy

# -------------------------
# –û–ü–ò–°–ê–ù–ò–Ø –ö–û–ù–°–¢–†–£–ö–¶–ò–ô
# -------------------------

NODE_EXPLANATIONS = {
    ast.Assign: "–ü—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.",
    ast.Expr: "–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è.",
    ast.Call: "–í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏.",
    ast.If: "–£—Å–ª–æ–≤–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä if.",
    ast.For: "–¶–∏–∫–ª for.",
    ast.While: "–¶–∏–∫–ª while.",
    ast.Compare: "–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π.",
    ast.BinOp: "–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è.",
    ast.Name: "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.",
    ast.Constant: "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ (—á–∏—Å–ª–æ, —Å—Ç—Ä–æ–∫–∞)."
}

# -------------------------
# –û–ë–™–Ø–°–ù–ï–ù–ò–ï AST
# -------------------------

def explain_node(node):
    for t, desc in NODE_EXPLANATIONS.items():
        if isinstance(node, t):
            return desc
    return "–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏."

# -------------------------
# –ü–û–®–ê–ì–û–í–û–ï –û–ë–™–Ø–°–ù–ï–ù–ò–ï
# -------------------------

def explain_code(code):
    print("\nüìñ –û–ë–™–Ø–°–ù–ï–ù–ò–ï –ö–û–î–ê –ü–û –°–¢–†–û–ö–ê–ú\n")

    env = {}
    prev_env = {}

    lines = code.splitlines()

    for i, line in enumerate(lines, 1):
        if not line.strip():
            continue

        print(f"üîπ –°—Ç—Ä–æ–∫–∞ {i}: {line}")

        try:
            tree = ast.parse(line)
            for node in ast.walk(tree):
                text = explain_node(node)
                if text:
                    print("   ‚û§", text)
                    break
        except:
            print("   ‚û§ –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫—É")

        try:
            exec(line, env)
        except Exception as e:
            print("   ‚ùå –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:", e)
            break

        changed = {}
        for k in env:
            if not k.startswith("__"):
                if k not in prev_env or prev_env[k] != env[k]:
                    changed[k] = env[k]

        if changed:
            print("   üß† –ò–∑–º–µ–Ω–∏–ª–∏—Å—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:", changed)
        else:
            print("   ‚Ñπ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å")

        prev_env = copy.deepcopy(env)

    print("\n‚úÖ –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ.")

# -------------------------
# –ü–ï–°–û–ß–ù–ò–¶–ê
# -------------------------

def sandbox():
    print("\nüß™ –ü–ï–°–û–ß–ù–ò–¶–ê PYTHON")
    print("–í–≤–æ–¥–∏ –∫–æ–¥ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ. –ù–∞–ø–∏—à–∏ '–∫–æ–Ω–µ—Ü' –¥–ª—è –∑–∞–ø—É—Å–∫–∞.\n")

    code = []
    while True:
        line = input()
        if line.strip().lower() == "–∫–æ–Ω–µ—Ü":
            break
        code.append(line)

    code_text = "\n".join(code)

    print("\n‚ñ∂ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:\n")
    try:
        exec(code_text)
    except Exception as e:
        print("‚ùå –û—à–∏–±–∫–∞:", e)

    explain = input("\n‚ùì –û–±—ä—è—Å–Ω–∏—Ç—å –∫–æ–¥ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ? (–¥–∞/–Ω–µ—Ç): ").lower()
    if explain == "–¥–∞":
        explain_code(code_text)
